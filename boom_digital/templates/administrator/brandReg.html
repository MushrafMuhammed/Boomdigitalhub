{% extends 'administrator/layout.html' %}
{% block title %}
    <title>Admin | Add Brand</title>
    {% endblock %}
{% block style %}
<style>
    .btn-main-2 {
        background: #e12454;
        color: #fff;
        border-color: #e12454;
        text-decoration: none;
        width: 40%;


    }

    .btn-main-2:hover {
        background: #223a66;
        color: #fff;
        border-color: #223a66;
    }
</style>
{% endblock %}



{% block content %}
<div class="container">
    <div class="row">

        <div class="card-body p-md-5 text-black">
            <h3 class="mb-5 text-uppercase"><b>Brand Registration</b></h3>

            <form method="POST" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="row">
                    
                    <div class="form-group mb-4">
                        <label for="inputEmail3" class="col-form-label">Category</label>
                        <div>
                            <select class="form-select" name="category" required>
                                <option value="">Select Category</option>
                                {%for category in categories%}
                                <option value="{{category.id}}">{{category.name}}</option>
                                {%endfor%}
                            </select>
                        </div>
                    </div>

                    <div class="form-group mb-4">
                        <label class="form-label" for="brand-name">Brand name</label>
                        <input type="text" id="brand_name" class="form-control form-control-lg" name="name" required/>
                        <span id="brand_status"></span>
                    </div>

                    <div class="form-group mb-4">
                        <label for="inputPassword3" class="col-form-label">Description</label>
                        <div>
                            <textarea class="form-control" id="descriptionField" placeholder="Write Description" rows="3"
                                style="margin-bottom: 20px;" name="description" required></textarea>
                        </div>
                    </div>

                    <div class="form-group mb-4">
                        <label class="form-label" for="form3Example8">logo</label>
                        <input type="file" class="form-control" name="logo" required/>
                    </div>
                </div>



                <div class="d-flex justify-content-center pt-3">
                    <button type="submit" class="btn-main-2 btn-round p-2 btn-lg ms-2">Add Band</button>
                </div>
            </form>

        </div>
    </div>
</div>

{% comment %} ajax_cdn  {% endcomment %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> 
<script>
    $(document).ready(function(){
        $('#brand_name').change(function(){
            var brandName = $(this).val();
            $.ajaxSetup({
                headers: {
                    "X-CSRFToken": $('[name=csrfmiddlewaretoken]').val()
                }
            })
            $.ajax({
                url: "{% url 'admin:brand_exist' %}",
                type: 'POST',
                data: {brand_name:brandName},

                success:function(response) {
                    var brandStatus = $('#brand_status');
                    if (response.exists) {
                        brandStatus.html('<i style="color:red">The brand already exist !</i>');
                    }else{
                        brandStatus.html('<i style="color:green;">Available !</i>');
                    }
                }
            })
        })
    })

    {% if successMessage %}
    // Display an alert box with the success message
    alert("{{ successMessage }}");
    {% endif %}
</script>

{% endblock %}